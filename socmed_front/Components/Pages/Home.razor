@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Nav
@inject AuthenticationStateProvider AuthStateProvider

<div class="container text-center mt-5">
    <div class="custom-card py-5 shadow-sm">
        <h1 class="display-4 fw-bold">SocMed</h1>
        <p class="lead text-muted">Добро пожаловать в вашу новую социальную сеть.</p>

        <AuthorizeView>
            <Authorized>
                <div class="mt-4">
                    @{
                        var userId = context.User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value
                        ?? context.User.FindFirst("sub")?.Value;
                    }

                    <div class="alert alert-info d-inline-block">
                        Вы вошли как <strong>@context.User.Identity?.Name</strong>
                    </div>

                    <div class="d-flex justify-content-center gap-3 mt-3">
                        @if (!string.IsNullOrEmpty(userId))
                        {
                            <button class="btn btn-primary btn-custom shadow-sm"
                                    @onclick='() => Nav.NavigateTo($"/profile/{userId}")'>
                                <i class="bi bi-person"></i> Мой профиль
                            </button>
                        }
                        <button class="btn btn-light border btn-custom" @onclick='() => Nav.NavigateTo("/users")'>
                            <i class="bi bi-people"></i> Найти людей
                        </button>
                    </div>
                </div>
            </Authorized>
            <NotAuthorized>
                <div class="mt-4">
                    <p class="mb-4">Присоединяйтесь к сообществу прямо сейчас!</p>
                    <div class="d-flex justify-content-center gap-3">
                        <button class="btn btn-primary btn-lg px-4" @onclick='() => Nav.NavigateTo("/login")'>
                            Войти
                        </button>
                        <button class="btn btn-outline-success btn-lg px-4" @onclick='() => Nav.NavigateTo("/register")'>
                            Регистрация
                        </button>
                    </div>
                </div>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>